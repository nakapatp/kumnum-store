<!DOCTYPE html>
<html lang="en">
<head>
  <title>ร้านหนังสือ "คำนำ" - หน้าแรก</title>

  <meta charset="utf-8">
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="">

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <!-- Css -->
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/magnific-popup.css" />
  <link rel="stylesheet" href="css/font-icons.css" />
  <link rel="stylesheet" href="css/sliders.css" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/animate.min.css" />

  <!-- Favicons -->
  <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">

</head>

<body class="relative">

  <!-- Preloader -->
  <div class="loader-mask">
    <div class="loader">
      <div></div>
      <div></div>
    </div>
  </div>

  <main class="content-wrapper oh">

    <!-- Navigation -->
    <header class="nav-type-1">

      <nav class="navbar navbar-static-top">
        <div class="navigation" id="sticky-nav">
          <div class="container relative">

            <div class="row">

              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>

              <div class="header-wrap">
                <div class="header-wrap-holder">
                  <!-- Search -->
                  <div class="nav-search hidden-sm hidden-xs">

                  </div>

                  <!-- Logo -->
                  <div class="logo-container">
                    <div class="logo-wrap text-center">
                      <a href="index.html">
                        <img class="logo" src="img/logo_dark.png" alt="logo">
                      </a>
                    </div>
                  </div>

                  <!-- Cart -->
                  <div class="nav-cart-wrap hidden-sm hidden-xs">

                  </div>

                </div>
              </div> <!-- end header wrap -->

              <div class="nav-wrap">
                <div class="collapse navbar-collapse" id="navbar-collapse">

                  <ul class="nav navbar-nav">
                    <li><a href="index.html">หน้าแรก</a></li>
                    <li class="dropdown"><a href="shop.html">ซื้อหนังสือ</a></li>
                    <li class="dropdown"><a href="info.html?id=sell">ขายหนังสือ</a></li>
                    <li class="dropdown"><a href="info2.html?id=produce">ผลิตหนังสือ</a></li>
                    <li class="dropdown"><a href="info.html?id=contact">ติดต่อเรา</a></li>
                    <li class="dropdown"><a href="checkout.html">ติดตามคำสั่งซื้อ</a></li>
                  </ul> <!-- end menu -->
                </div> <!-- end collapse -->
              </div> <!-- end col -->

            </div> <!-- end row -->
          </div> <!-- end container -->
        </div> <!-- end navigation -->
      </nav> <!-- end navbar -->
    </header> <!-- end navigation -->

    <!-- Hero Slider -->
    <section class="section-wrap nopadding">
      <div class="container">
        <div class="entry-slider">
          <div class="flexslider" id="flexslider-hero">
            <ul class="slides clearfix">
              <li>
                <img src="" alt="" id="hero-img">
                <div class="img-holder img-1"></div>
                <!-- Hero Banner
                <div class="hero-holder text-center right-align">
                  <div class="hero-lines">
                    <h1 class="hero-heading white" id="hero-title">"คำนำ"</h1>
                    <h4 class="hero-subheading white uppercase" id="hero-subtitle">มิติใหม่ของสื่อตำรา และเอกสารประกอบการเรียนการสอน</h4>--
                  </div>
                  a href="shop.html" class="btn btn-lg btn-white" id="hero-button"><span id="hero-button-caption">ซื้อหนังสือ</span></a>

                </div> - end hero banner -->
              </li>
              <!-- 2nd+ Hero Slider
              <li>
                <img src="" alt="">
                <div class="img-holder img-2"></div>
              </li>
              <li>
                <img src="" alt="">
                <div class="img-holder img-3"></div>
              </li> - end 2nd+ hero slider -->
            </ul>
          </div>
        </div> <!-- end slider -->
      </div>
    </section> <!-- end hero slider -->

    <!-- New Arrivals -->
    <section class="section-wrap new-arrivals pb-40">
      <div class="container" style="width:75%;">

        <div class="row heading-row">
          <div class="col-md-12 text-center">
            <h2 class="heading uppercase">หนังสือออกใหม่</h2>
          </div>
        </div>
        <div id="panel-highlight">
          <!-- Dynamic Content -->
        </div>
      </div>
    </section> <!-- end new arrivals -->

    <!-- Best Sellers -->
    <section class="section-wrap pb-0" style="margin-top:-50px;">
      <div class="container" style="width:75%;">

        <div class="row heading-row">
          <div class="col-md-12 text-center">
            <h2 class="heading uppercase">หนังสือขายดี</h2>
          </div>
        </div>
        <div id="panel-bestseller">
          <!-- Dynamic Content -->
        </div>
      </div>
    </section> <!-- end best sellers -->

    <!-- Footer Type-1 -->
    <footer class="footer footer-type-1 bg-white">
      <div class="bottom-footer bg-white">
        <div class="container">
          <div class="row">
            <div class="col-sm-4 copyright sm-text-center">
              <span>
                &copy; 2021 "คำนำ"
              </span>
            </div>

            <div class="col-sm-4 text-center">
              <div id="back-to-top">
                <a href="#top">
                  <i class="fa fa-angle-up"></i>
                </a>
              </div>
            </div>

            <!-- Social -->
            <div class="col-sm-4 col-xs-12 footer-payment-systems text-right sm-text-center mt-sml-10">
              <a href="" id="social-facebook"><i class="fa fa-facebook"></i></a>
            </div>

          </div>
        </div>
      </div> <!-- end bottom footer -->
    </footer> <!-- end footer -->

  </main> <!-- end main container -->

  <!-- jQuery Scripts -->
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/plugins.js"></script>
  <script type="text/javascript" src="js/scripts.js"></script>

  <!-- KumNum Store JavaScript -->
  <script type="text/javascript" src="js/manutils.js"></script>

  <script type="text/javascript">
    const sheetURL = 'https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc'; // Production
    //const sheetURL = 'https://sheet.best/api/sheets/86299b5c-1850-4f51-b969-a44721bfe390'; // Dev
    var globalVars = null;
    var arrHighlight = null;
    var arrBestSeller = null;

    function init() {
      // Hero Slider
      //document.getElementById('hero-img').src = manUtils.getGlobalVars('indexHeroImage');
      //document.getElementById('hero-title').innerHTML = manUtils.getGlobalVars('indexHeroTitle');
      //document.getElementById('hero-subtitle').innerHTML = manUtils.getGlobalVars('indexHeroSubTitle');
      //document.getElementById('hero-button-caption').innerHTML = manUtils.getGlobalVars('indexHeroButtonCaption');
      //document.getElementById('hero-button').href = manUtils.getGlobalVars('indexHeroButtonLink');

      // Footer Link
      document.getElementById('social-facebook').href = manUtils.getGlobalVars('facebookURL');

      if (arrHighlight) {
        var panelBook = document.getElementById('panel-highlight');
        var n = 0;
        for (var i in arrHighlight) {
          var data = {
            Title: arrHighlight[i].Title,
            Author: arrHighlight[i].Author,
            ImageFront: arrHighlight[i].ImageFull,
            ImageBack: arrHighlight[i].ImageFull,
            URLSingleProduct: 'shop.html?id=' + arrHighlight[i].ContactId + '&book=' + arrHighlight[i].ProductId,
            URLShop: 'shop.html?id=' + arrHighlight[i].ContactId,
            Price: arrHighlight[i].Price,
          }
          if (n % 4 == 0) {
            var div = document.createElement('div');
            div.className = "row";
            div.id = "row-highlight-" + Math.floor(n/4);
            panelBook.appendChild(div);
            spawnBook(div, data);
          } else {
            var div = document.getElementById('row-highlight-' + Math.floor(n/4));
            spawnBook(div, data);
          }
          n++;
        }
      }

      if (arrBestSeller) {
        var panelBook = document.getElementById('panel-bestseller');
        var n = 0;
        for (var i in arrBestSeller) {
          var data = {
            Title: arrBestSeller[i].Title,
            Author: arrBestSeller[i].Author,
            ImageFront: arrBestSeller[i].ImageFull,
            ImageBack: arrBestSeller[i].ImageFull,
            URLSingleProduct: 'shop.html?id=' + arrBestSeller[i].ContactId + '&book=' + arrBestSeller[i].ProductId,
            URLShop: 'shop.html?id=' + arrBestSeller[i].ContactId,
            Price: arrBestSeller[i].Price,
          }
          if (n % 4 == 0) {
            var div = document.createElement('div');
            div.className = "row";
            div.id = "row-bestseller-" + Math.floor(n/4);
            panelBook.appendChild(div);
            spawnBook(div, data);
          } else {
            var div = document.getElementById('row-bestseller-' + Math.floor(n/4));
            spawnBook(div, data);
          }
          n++;
        }
      }
    }
    function loadBestSeller() {
      fetch(sheetURL + '/tabs/Products/BestSeller/*True*')
      .then((response) => { return response.json(); })
      .then((myJson) => {
        arrBestSeller = myJson;

        init();
      })
      .catch((error) => { console.log(error); });
    }
    function loadHighlight() {
      fetch(sheetURL + '/tabs/Products/Highlight/*True*')
      .then((response) => { return response.json(); })
      .then((myJson) => {
        arrHighlight = myJson;

        loadBestSeller();
      })
      .catch((error) => { console.log(error); });
    }
    function spawnBook(panel, data, animate) {
      var div = document.createElement('div');
      div.className = 'col-md-3';
      var html = "";

      //html += '<div class="col-md-3 col-xs-6' + (animate ? ' animated-from-left' : '') + '">';
        html += '<div class="product-item">';
          html += '<div class="product-img">';
            html += '<a href="' + data.URLSingleProduct + '">';
              html += '<img src="' + data.ImageFront + '" alt="">';
              html += '<img src="' + data.ImageBack + '" alt="" class="back-img">';
            html += '</a>';
            html += '<a href="' + data.URLSingleProduct + '" class="product-quickview"><big>รายละเอียดหนังสือ</big></a>';
          html += '</div>';
          html += '<div class="product-details">';
            html += '<h3><a class="product-title" href="' + data.URLSingleProduct + '">' + data.Title + '</a></h3>';
            html += '<span class="price">';
              html += '<ins><span class="ammount"><a href="' + data.URLShop + '">' + data.Author + '</a></span></ins>';
              html += '<h6 class="ammount">ราคา ' + data.Price + ' บาท</h6>';
            html += '</span>';
          html += '</div>';
        html += '</div>';
      //html += '</div>';

      div.innerHTML = html;
      panel.appendChild(div);
    }
    window.addEventListener('load', (event) => {
      // GET GlobalVars
      // -- GET Highlight
      // ---- GET Bestseller
      fetch(sheetURL + '/tabs/GlobalVars')
      .then((response) => { return response.json(); })
      .then((myJson) => {
        globalVars = myJson;

        loadHighlight();
      })
      .catch((error) => { console.log(error); });
    });
  </script>

</body>
</html>
