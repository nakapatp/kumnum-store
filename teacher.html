<!DOCTYPE html>
<html lang="en">
<head>
  <title>ร้านหนังสือ "คำนำ" - หน้าแรก</title>

  <meta charset="utf-8">
  <!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'><![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="">

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <!-- Css -->
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/magnific-popup.css" />
  <link rel="stylesheet" href="css/font-icons.css" />
  <link rel="stylesheet" href="css/sliders.css" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/animate.min.css" />

  <!-- Favicons -->
  <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">

</head>

<body class="relative">

  <!-- Preloader -->
  <div class="loader-mask">
    <div class="loader">
      <div></div>
      <div></div>
    </div>
  </div>

  <main class="content-wrapper oh">

    <!-- Navigation -->
    <header class="nav-type-1">

      <nav class="navbar navbar-static-top">
        <div class="navigation" id="sticky-nav">
          <div class="container relative">

            <div class="row">

              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
              </div>

              <div class="header-wrap">
                <div class="header-wrap-holder">
                  <!-- Search -->
                  <div class="nav-search hidden-sm hidden-xs">

                  </div>

                  <!-- Logo -->
                  <div class="logo-container">
                    <div class="logo-wrap text-center">
                      <a href="index.html">
                        <img class="logo" src="img/logo_dark.png" alt="logo">
                      </a>
                    </div>
                  </div>

                  <!-- Cart -->
                  <div class="nav-cart-wrap hidden-sm hidden-xs">

                  </div>

                </div>
              </div> <!-- end header wrap -->

              <div class="nav-wrap">
                <div class="collapse navbar-collapse" id="navbar-collapse">

                  <ul class="nav navbar-nav">
                    <li><a href="index.html">หน้าแรก</a></li>
                    <li class="dropdown"><a href="shop.html">ซื้อหนังสือ</a></li>
                    <li class="dropdown"><a href="info.html?id=sell">ขายหนังสือ</a></li>
                    <li class="dropdown"><a href="info2.html?id=produce">ผลิตหนังสือ</a></li>
                    <li class="dropdown"><a href="info.html?id=contact">ติดต่อเรา</a></li>
                    <li class="dropdown"><a href="checkout.html">ติดตามคำสั่งซื้อ</a></li>
                  </ul> <!-- end menu -->
                </div> <!-- end collapse -->
              </div> <!-- end col -->

            </div> <!-- end row -->
          </div> <!-- end container -->
        </div> <!-- end navigation -->
      </nav> <!-- end navbar -->
    </header> <!-- end navigation -->

    <!-- Teachers -->
    <section class="section-wrap new-arrivals pb-40">
      <div class="container" style="width:75%;">

        <div class="row heading-row">
          <div class="col-md-12 text-center">
            <h2 class="heading uppercase">ผู้เขียน / ผู้เรียบเรียง</h2>
          </div>
        </div>
        <div id="panel-highlight">
          <!-- Dynamic Content -->
        </div>
      </div>
    </section> <!-- end new arrivals -->


    <!-- Footer Type-1 -->
    <footer class="footer footer-type-1 bg-white">
      <div class="bottom-footer bg-white">
        <div class="container">
          <div class="row">
            <div class="col-sm-4 copyright sm-text-center">
              <span>
                &copy; 2021 "คำนำ"
              </span>
            </div>

            <div class="col-sm-4 text-center">
              <div id="back-to-top">
                <a href="#top">
                  <i class="fa fa-angle-up"></i>
                </a>
              </div>
            </div>

            <!-- Social -->
            <div class="col-sm-4 col-xs-12 footer-payment-systems text-right sm-text-center mt-sml-10">
              <a href="" id="social-facebook"><i class="fa fa-facebook"></i></a>
            </div>

          </div>
        </div>
      </div> <!-- end bottom footer -->
    </footer> <!-- end footer -->

  </main> <!-- end main container -->

  <!-- jQuery Scripts -->
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js/plugins.js"></script>
  <script type="text/javascript" src="js/scripts.js"></script>

  <!-- KumNum Store JavaScript -->
  <script type="text/javascript" src="js/manutils.js"></script>

  <script type="text/javascript">
    const sheetURL = 'https://sheet.best/api/sheets/5acb1568-5ff2-4717-81dc-23a4093f6cbc'; // Production
    //const sheetURL = 'https://sheet.best/api/sheets/86299b5c-1850-4f51-b969-a44721bfe390'; // Dev
    var globalVars = null;
    var arrContacts = null;

    function init() {
      // Footer Link
      document.getElementById('social-facebook').href = manUtils.getGlobalVars('facebookURL');

      // Number of Contacts
      //document.getElementById('num-of-contacts').innerHTML = manUtils.getGlobalVars('numOfContacts');

      if (arrContacts) {
        var panelBook = document.getElementById('panel-highlight');
        var n = 0;
        for (var i in arrContacts) {
          var data = {
            Biography: arrContacts[i].Biography,
            Author: manUtils.formatName(arrContacts[i].Title, arrContacts[i].FirstName, arrContacts[i].LastName),
            ImageFront: arrContacts[i].ImageProfile,
            ImageBack: arrContacts[i].ImageProfile,
            URLShop: manUtils.getGlobalVars('shopURL') + '?id=' + arrContacts[i].ContactId,
          }
          if (n % 4 == 0) {
            var div = document.createElement('div');
            div.className = "row";
            div.id = "row-highlight-" + Math.floor(n/4);
            panelBook.appendChild(div);
            spawnContact(div, data);
          } else {
            var div = document.getElementById('row-highlight-' + Math.floor(n/4));
            spawnContact(div, data);
          }
          n++;
        }
      }
    }

    function loadContacts() {
      fetch(sheetURL + '/tabs/Contacts')
      .then((response) => { return response.json(); })
      .then((myJson) => {
        arrContacts = myJson;

        init();
      })
      .catch((error) => { console.log(error); });
    }

    function spawnContact(panel, data, animate) {
      var div = document.createElement('div');
      div.className = 'col-md-3';
      var html = "";

      //html += '<div class="col-md-3 col-xs-6' + (animate ? ' animated-from-left' : '') + '">';
        html += '<div class="product-item">';
          html += '<div class="product-img">';
            html += '<a href="' + data.URLShop + '">';
              html += '<img src="' + data.ImageFront + '" alt="">';
              //html += '<img src="' + data.ImageBack + '" alt="" class="back-img">';
            html += '</a>';
            html += '<a href="' + data.URLShop + '" class="product-quickview"><big>ร้านหนังสือส่วนตัว</big></a>';
          html += '</div>';
          html += '<div class="product-details" style="margin-top:-15px;">';
            html += '<span class="price">';
              html += '<ins><span class="ammount"><a href="' + data.URLShop + '">' + data.Author + '</a></span></ins>';
              //html += '<h6 class="ammount">ราคา ' + data.Price + ' บาท</h6>';
            html += '</span>';
            html += '<h3>' + data.Biography + '</h3>';
          html += '</div>';
        html += '</div>';
      //html += '</div>';

      div.innerHTML = html;
      panel.appendChild(div);
    }

    window.addEventListener('load', (event) => {
      // GET GlobalVars
      // -- GET Contacts
      fetch(sheetURL + '/tabs/GlobalVars')
      .then((response) => { return response.json(); })
      .then((myJson) => {
        globalVars = myJson;

        loadContacts();
      })
      .catch((error) => { console.log(error); });
    });
  </script>

</body>
</html>
